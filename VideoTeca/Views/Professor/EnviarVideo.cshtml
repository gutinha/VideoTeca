@using VideoTeca.Models
@{
    ViewBag.Title = "Enviar video";
    List<area> areas = ViewBag.Areas;
}

<form method="post" id="myForm">
    <div class="form-floating mb-3">
        <input type="text" class="form-control" id="floatingInputTitulo" placeholder="Título ou Palavras-Chave">
        <label for="floatingInputTitulo">Título:</label>
    </div>
    <div class="form-group">
        <label for="floatingInputDescricao">Descrição:</label>
        <textarea class="form-control" id="descricao" name="descricao" maxlength="4000"></textarea>
    </div>
    <div class="form-floating mb-3">
        <input type="text" class="form-control" id="floatingInputLink" placeholder="Link do video">
        <label for="floatingInputLink">Link do video:</label>
    </div>
    <div class="row gx-2 mb-5">
        <div class="col-5 col-lg-3">
            <div class="form-floating">
                <select class="form-select" id="floatingSelect1" aria-label="Floating label select example">
                    <option selected hidden>Escolha uma área</option>
                    @foreach (var area in ViewBag.Areas)
                    {
                        <option value="@area.id">@area.nome</option>
                    }
                </select>
                <label for="floatingSelect">Área</label>
            </div>
        </div>

        <div class="col-5 col-lg-3">
            <div class="form-floating">
                <select class="form-select" id="floatingSelect" aria-label="Floating label select example" disabled="">
                    <option selected hidden></option>
                </select>
                <label for="floatingSelect">Subárea</label>
            </div>
        </div>
    </div>
    <div class="form-group form-check">
        <input type="checkbox" class="form-check-input" id="aceitarTermos" name="aceitarTermos">
        <label class="form-check-label" for="aceitarTermos">Aceitar os termos</label>
    </div>
    <button type="submit" class="btn btn-primary offset-11" style="float:right" id="enviarBtn" disabled>Enviar</button>
</form>

@section Scripts {
    <script>
        document.getElementById('aceitarTermos').onchange = function () {
            document.getElementById('enviarBtn').disabled = !this.checked;
        };

        function BuscarSubArea() {
    var areaId = $('#floatingSelect1').val();
    $.ajax({
        dataType: "json",
        method: "POST",
        url: "@Url.Action("BuscarSubArea", "Professor")",
        data: { id: areaId },
    }).done(function (data) {
        var select = $("#floatingSelect");
        select.empty();
        select.append($('<option>', { value: '', text: 'Escolha uma Subárea' }));

        
        data.forEach(function (item) {
            select.append($('<option>', {
                value: item.Id,
                text: item.Nome
            }));
        });

        select.prop('disabled', false); 
    }).fail(function (jqXHR, textStatus, errorThrown) {
        console.error('Erro na chamada AJAX: ' + textStatus);
    });
}


        $('#floatingSelect1').on("change", function (event) {
            BuscarSubArea();
        });
    </script>
}

