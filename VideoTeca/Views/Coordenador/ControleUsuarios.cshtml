@using VideoTeca.Models
@{
    ViewBag.Title = "Controle Usuários";
    List<usuario> usuarios = ViewBag.Usuarios;
}

<div class="list-group" style="margin-top: 5px;">
    <span class="list-group-item active">
        <h3 class="list-group-item-heading" align="center">Listagem de usuários</h3>
    </span>
    <div class="panel panel-primary table-responsive">
    </div>
</div>
<br />
<div class="row">
    <div class="col-lg-12">
        <div class="row">
            <div class="form-group col-lg-4">
                <label for="Grupo" class="control-label">Grupos</label>
                <br />
                <select class="form-control filtro" id="Grupo" name="Grupo" tabindex="1">
                    <option value="0">Todos</option>
                    <option value="1">Usuário</option>
                    <option value="2">Professor</option>
                    <option value="3">Avaliador</option>
                    <option value="4">Dicom</option>
                    <option value="5">Coordenador</option>
                </select>
            </div>
        </div>
    </div>
</div>
<table id="table"
       data-toolbar="#filtro"
       data-search="true"
       data-show-refresh="false"
       data-show-toggle="false"
       data-show-columns="false"
       data-show-export="true"
       data-detail-view="false"
       data-detail-formatter="detailFormatter"
       data-show-pagination-switch="false"
       data-pagination="true"
       data-id-field="id"
       data-page-list="[10, 25, 50, 100]"
       data-show-footer="false"
       data-side-pagination="server"
       data-url="@Url.Action("ListarUsuariosAjax","Coordenador")"
       data-locale="pt-BR"></table>
@section styles {
    <link href="~/Content/lib/bootstrap-table/bootstrap-table.min.css" rel="stylesheet" />
    <style>
        a:hover {
            cursor: pointer;
        }
    </style>
}
@section scripts{
    <script src="~/Content/lib/bootstrap-table/bootstrap-table.min.js"></script>
    <script src="~/Content/lib/bootstrap-table/locale/bootstrap-table-pt-BR.min.js"></script>
    <link href="~/Content/css/select2.min.css" rel="stylesheet" />
    <script>
        $(function() {
            $('[data-toggle="tooltip"]').tooltip();
        });

        var $table = $('#table');
        $(function() {
            $table.bootstrapTable({
                columns:
                [
                    {
                        title: 'Item ID',
                        field: 'id',
                        visible: false
                    },
                    {
                        title: 'Nome',
                        field: 'nome',
                        align: 'center',
                        sortable: true
                    },
                    {
                        title: 'Email',
                        field: 'email',
                        align: 'center',
                        //formatter: statusFormatter,
                        sortable: true
                    },
                    {
                        title: 'Grupo',
                        field: 'permission',
                        align: 'center',
                        //formatter: statusFormatter,
                        sortable: true
                    },
                    {
                        title: 'Ação',
                        field: 'operate',
                        align: 'center',
                        formatter: operateFormatter,
                        width: '200px'
                    }
                ]
            });
        });

        function operateFormatter(value, row, index) {
            var texto = [];
            texto.push('<a href="#" class="informacao" ><i title="Informações" class="fas fa-search fa-lg " data-original-title="Informações"></i></a>');
            texto.push('<a href="@Url.Action("EditarUsuario", "Coordenador")/' + row.id + '"><i title="Editar" class="fas fa-edit fa-lg" data-original-title="Editar"></i></a>');
            texto.push('<a href="#" class="excluir" ><i title="Excluir" class="fas fa-trash-alt fa-lg " data-original-title="Excluir"></i></a>');
            return texto.join('&nbsp;&nbsp;');
        }

        $(document).ready(function() {
            $('input.form-control').focus();
        });

        $(document).ready(function () {

            $("#Grupo").select2({
                placeholder: "Selecionar...",
                language: {
                    noResults: function () {
                        return "Não Encontrado.";
                    },
                    searching: function () {
                        return "Procurando...";
                    }
                }
            });
        });

        $( ".filtro" ).change(function() {
           /* alert("Handler for .change() called.");*/
            var grupo = $('#Grupo').val();
            var link = '@Url.Action("ListarUsuariosAjax", "Coordenador")/?Grupo=' + grupo;
            $table.bootstrapTable('refresh', { url: link });
        });


    </script>
}



